parameter_definition:

  livetime:
    nominal_value: 1.
    ptype: livetime
    fittable: false
    description: Livetime of XLZD in multiples of 1 ty

  # signal:
  WIMP_rate_multiplier:
    nominal_value: 1.0
    ptype: rate
    fittable: true
    fit_limits:
      - 0
      - null
    parameter_interval_bounds:
      - 0
      - null
    fit_guess: 0.001

  wimp_mass:
    nominal_value: 40.
      #ptype: shape
      #fittable: true
    description: WIMP mass in GeV/c^2
    blueice_anchors: 
      - 10
      - 16
      - 19
      - 32
      - 36
      - 40
      - 46
      - 60
      - 65
      - 91
      - 129
      - 182
      - 361
      - 508
      - 1000
    fit_limits: 
      - 6.0
      - 1000.0
    parameter_interval_bounds:
      - 6.0
      - 1000.0

  PMT_quantum_efficiency:
    nominal_value: 0.31
    fittable: false
    description: probability for a photon to be detected by a PMT

  drift_field:
    nominal_value: 80.
    fittable: false
    description: liquid drift field in V/cm

  electron_livetime:
    nominal_value: 10.
    fittable: false
    description: electron livetime in ms

  gas_field: 
    nominal_value: 7.5
    fittable: false
    description: gas extraction field in kV/cm

  # NR bkg:

  CEvNS_solar_rate_multiplier:
    nominal_value: 1.0
    ptype: rate
    uncertainty: 0.0464
    relative_uncertainty: true
    fittable: true
    fit_limits:
      - 0
      - null
    fit_guess: 1.0

  neutron_rate_multiplier:
    nominal_value: 1.0
    ptype: rate
    uncertainty: 0.2
    relative_uncertainty: true
    fittable: true
    fit_limits:
      - 0
      - null
    fit_guess: 1.0


  CEvNS_other_rate_multiplier:
    nominal_value: 1.0
    ptype: rate
    uncertainty: 0.195
    relative_uncertainty: true
    fittable: true
    fit_limits:
      - 0
      - null
    fit_guess: 1.0

  # ER bkg: 

  SolarER_rate_multiplier:
    nominal_value: 1.0
    ptype: rate
    uncertainty: 0.0464
    relative_uncertainty: true
    fittable: true
    fit_limits:
      - 0
      - null
    fit_guess: 1.0

  Xe136_rate_multiplier:
    nominal_value: 1.0
    ptype: rate
    uncertainty: 0.15
    relative_uncertainty: true
    fittable: true
    fit_limits:
      - 0
      - null
    fit_guess: 1.0

  Xe124_rate_multiplier:
    nominal_value: 1.0
    ptype: rate
    uncertainty: 0.20
    relative_uncertainty: true
    fittable: true
    fit_limits:
      - 0
      - null
    fit_guess: 1.0

  Pb214_rate_multiplier:
    nominal_value: 1.0
    ptype: rate
    uncertainty: 0.167
    relative_uncertainty: true
    fittable: true
    fit_limits:
      - 0
      - null
    fit_guess: 1.0

  Kr85_rate_multiplier:
    nominal_value: 1.0
    ptype: rate
    uncertainty: 0.167
    relative_uncertainty: true
    fittable: true
    fit_limits:
      - 0
      - null
    fit_guess: 1.0



likelihood_config:
  likelihood_weights: [1]
  template_folder: /Users/kdund/Desktop/xlzd_reqtask_nufog/templates_v1.0/ # will try to find the templates in alea
  likelihood_terms:
    # SR0
    - name: sr0
      default_source_class: alea.template_source.TemplateSource
      likelihood_type: blueice.likelihood.UnbinnedLogLikelihood
        #likelihood_type: blueice.likelihood.BinnedLogLikelihood
      analysis_space:
        - cs1: np.linspace(0, 100, 101)
        - log10_cs2: np.linspace(2.5,4., 101)
        - rsq: np.linspace(0,21542.900625, 51)
      in_events_per_bin: true
      livetime_parameter: livetime
      slice_args: {}
      sources:
      # Signal 
      - name: WIMP
        histname: WIMP{wimp_mass:.0f}
        parameters:
          - wimp_mass
          - WIMP_rate_multiplier
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        named_parameters:
          - wimp_mass
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        template_filename: templates_v1.0__PMT_quantum_efficiency_{PMT_quantum_efficiency:.2f}_drift_field_{drift_field:.2f}_electron_livetime_{electron_livetime:.2f}_gas_field_{gas_field:.2f}.ii.h5
        histogram_scale_factor: 1.
        normalise_template: false

      - name: neutron
        histname: neutrons
        parameters:
          - neutron_rate_multiplier
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        named_parameters:
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        template_filename: templates_v1.0__PMT_quantum_efficiency_{PMT_quantum_efficiency:.2f}_drift_field_{drift_field:.2f}_electron_livetime_{electron_livetime:.2f}_gas_field_{gas_field:.2f}.ii.h5
        histogram_scale_factor: 1.
        normalise_template: false


      # NR backgrounds 
      - name: CEvNS_solar
        histname: CEvNS_solar
        parameters:
          - CEvNS_solar_rate_multiplier
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        named_parameters:
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        template_filename: templates_v1.0__PMT_quantum_efficiency_{PMT_quantum_efficiency:.2f}_drift_field_{drift_field:.2f}_electron_livetime_{electron_livetime:.2f}_gas_field_{gas_field:.2f}.ii.h5
        histogram_scale_factor: 1.

      - name: CEvNS_other
        histname: CEvNS_other_LNGS
        parameters:
          - CEvNS_other_rate_multiplier
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        named_parameters:
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        template_filename: templates_v1.0__PMT_quantum_efficiency_{PMT_quantum_efficiency:.2f}_drift_field_{drift_field:.2f}_electron_livetime_{electron_livetime:.2f}_gas_field_{gas_field:.2f}.ii.h5
        histogram_scale_factor: 1.
      
      # ER backgrounds 

      - name: SolarER
        histname: SolarER
        parameters:
          - SolarER_rate_multiplier
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        named_parameters:
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        template_filename: templates_v1.0__PMT_quantum_efficiency_{PMT_quantum_efficiency:.2f}_drift_field_{drift_field:.2f}_electron_livetime_{electron_livetime:.2f}_gas_field_{gas_field:.2f}.ii.h5
        histogram_scale_factor: 1.

      - name: Xe136
        histname: Xe136
        parameters:
          - Xe136_rate_multiplier
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        named_parameters:
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        template_filename: templates_v1.0__PMT_quantum_efficiency_{PMT_quantum_efficiency:.2f}_drift_field_{drift_field:.2f}_electron_livetime_{electron_livetime:.2f}_gas_field_{gas_field:.2f}.ii.h5
        histogram_scale_factor: 1.

      - name: Xe124
        histname: Xe124
        parameters:
          - Xe136_rate_multiplier
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        named_parameters:
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        template_filename: templates_v1.0__PMT_quantum_efficiency_{PMT_quantum_efficiency:.2f}_drift_field_{drift_field:.2f}_electron_livetime_{electron_livetime:.2f}_gas_field_{gas_field:.2f}.ii.h5
        histogram_scale_factor: 1.

      - name: Pb214
        histname: Pb214
        parameters:
          - Pb214_rate_multiplier
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        named_parameters:
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        template_filename: templates_v1.0__PMT_quantum_efficiency_{PMT_quantum_efficiency:.2f}_drift_field_{drift_field:.2f}_electron_livetime_{electron_livetime:.2f}_gas_field_{gas_field:.2f}.ii.h5
        histogram_scale_factor: 1.

      - name: Kr85
        histname: Kr85
        parameters:
          - Kr85_rate_multiplier
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        named_parameters:
          - PMT_quantum_efficiency
          - drift_field
          - electron_livetime
          - gas_field
        template_filename: templates_v1.0__PMT_quantum_efficiency_{PMT_quantum_efficiency:.2f}_drift_field_{drift_field:.2f}_electron_livetime_{electron_livetime:.2f}_gas_field_{gas_field:.2f}.ii.h5
        histogram_scale_factor: 1.




# just for illusrative purposes, the default values are shown here.
# they are not needed in the configuration file but you could
# overwrite them here.
fit_strategy:
  disable_index_fitting: False
  max_index_fitting_iter: 10
  minimizer_routine: "migrad"
  minuit_strategy: 1
  refit_invalid: True
